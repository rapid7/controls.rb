{"name":"ControlsInsight API","tagline":"","body":"# controlsinsight client gem\r\n[![Build Status](https://travis-ci.org/erran-r7/controls.rb.png?branch=master)](https://travis-ci.org/erran-r7/controls.rb)\r\n\r\nThe **controls**insight (controls) gem interfaces with [Rapid7's **controls**insight API](http://rapid7.github.io/controlsinsight.rb).\r\n\r\n## Installation\r\nAdd this line to your application's Gemfile:\r\n\r\n```ruby\r\ngem 'controls'\r\n```\r\n\r\nAnd then execute:\r\n```bash\r\nbundle\r\n```\r\n\r\nOr install it yourself as:\r\n```bash\r\ngem install controls\r\n```\r\n\r\n## Documentation\r\n* [API documentation](http://rapid7.github.io/controlsinsight.rb)\r\n* [YARD documentation for the Ruby client](http://www.rubydoc.info/github/rapid7/controlsinsight.rb)\r\n\r\n## Basic Resources\r\n### Authentication\r\n```ruby\r\nControls.web_endpoint = 'https://nexpose.local:3780/insight/controls'\r\nControls.api_endpoint = \"#{Controls.web_endpoint}/api/1.0\"\r\n\r\n# If your endpoint uses a self-signed cert. turn off SSL cert. verification\r\nControls.verify_ssl = false\r\n\r\nControls.login :user => 'admin', :password => 'password'\r\n\r\nControls.client.api_methods\r\n# => [:applicable_assets, :assessments, :asset_search, :assets, :assets_by_configuration, :assets_by_guidance, ..., :uncovered_assets, :undefended_assets, :update_security_controls]\r\n```\r\n\r\n### Assessments\r\n```ruby\r\n# Retrieve all the assessments that have been ran\r\nControls.assessments\r\n# => [#<Controls::Assessment: id: 1, timestamp: 2013-12-15 10:07:39 -0600, assessing: false, high_risk_asset_count: 18,\r\n#     medium_risk_asset_count: 0, low_risk_asset_count: 0, total_asset_count: 18, overall_risk_score: 1.1723226070935302>]\r\n\r\n# Only retrieve a single assessment\r\nControls.assessments(2)\r\n# => #<Controls::Assessment: id: 2, timestamp: 2014-02-06 17:35:02 -0600, assessing: false, high_risk_asset_count: 0,\r\n#    medium_risk_asset_count: 42, low_risk_asset_count: 0, total_asset_count: 42, overall_risk_score: 3.687419753008327>\r\n```\r\n\r\n\r\n### Assets\r\n```ruby\r\n# Retrieve a list of all the assets that Controls has access to\r\nControls.assets\r\n# => [\r\n#      #<Controls::Asset: discovered_at: 2013-12-15 09:55:47 -0600, operating_system: Windows 7 Professional Edition,\r\n#      operating_system_certainty: 1.0, security_control_findings: [...], risk_level: MEDIUM, risk_score:\r\n#      5.554266115196547, owner: Administrator, name: 10.4.19.25, host_name: CMMNCTR2K7R2-U, ipaddress: 10.4.19.25,\r\n#      uuid: db899a57-347c-4df9-9ce2-6932dc4adf38>,\r\n#      ...\r\n#    ]\r\n\r\n# Only retrieve a single assessment\r\nControls.assets('335fb288-da73-4d3c-afe9-b6a1506bf907')\r\n# => #<Controls::Asset: discovered_at: 2013-12-15 09:55:48 -0600, operating_system: Windows 7 Enterprise Edition, \r\n#    operating_system_certainty: 1.0, security_control_findings: [...], risk_level: MEDIUM, risk_score: \r\n#    4.724118340950002, owner: Administrator, name: 10.4.19.24, host_name: V-OFC-COMPAT-P, ipaddress: 10.4.19.24,\r\n#    uuid: 335fb288-da73-4d3c-afe9-b6a1506bf907>\r\n```\r\n\r\n### Configuration\r\n```ruby\r\nControls.configurations\r\n# => [\r\n#      #<Controls::Configuration: coverage: #<Controls::CoverageItem: total: 42, covered: 1, uncovered: 41, percent_covered: 2.380952380952381>, assessment_timestamp: 2014-02-06 17:58:06 -0600,\r\n#      name: unique-password, title: unique password>\r\n#      ...,\r\n#      #<Controls::Configuration: coverage: #<Controls::CoverageItem: total: 3, covered: 3, uncovered: 0, percent_covered: 100.0>, assessment_timestamp: 2014-02-06 17:58:06 -0600,\r\n#      name: email-attachment-filtering-enabled, title: E-mail client attachment filtering enabled>\r\n#    ]\r\n\r\nControls.configurations('antivirus-installed')\r\n# => #<Controls::Configuration: coverage: #<Dish::Plate:0x007fb052ce9e10>, assessment_timestamp: 2014-02-06 17:58:06 -0600,\r\n#    name: antivirus-installed, title: antivirus installed>\r\n```\r\n\r\n### Guidance\r\n```ruby\r\n# Retreive a list of guidance applicable to a specific threat\r\nControls.guidance_by_threat('overall-malware')\r\n# => [...]\r\n\r\n# Only retrieve a single guidance by name\r\nControls.guidance('your-guidance-name-here')\r\n# => #<Dish::Plate: assessment_timestamp: 1391731086251, sans_reference: , dsd_reference: , nist_reference: , \r\n#    sections: [...], domain: Desktop, references: [...], target_grade: 3.2759693577089286, improvement_delta: \r\n#    0.007545795822296775, improvement_grade: 3.2759693577089286, name: enable-uac, title: Enable User Account Control (UAC)>\r\n\r\nControls.prioritized_guidance_by_security_control('desktops-with-antivirus-deployed').count\r\n# => 3\r\n```\r\n\r\n### Security Controls\r\n```ruby\r\nControls.security_controls\r\n# => [\r\n#      #<Controls::SecurityControl: enabled: true, name: desktops-with-up-to-date-high-risk-applications>,\r\n#      ...,\r\n#      #<Controls::SecurityControl: enabled: true, name: desktops-with-email-attachment-filtering-enabled>\r\n#    ]\r\n\r\nControls.security_controls('code-execution-prevention')\r\n# => #<Controls::SecurityControl: enabled: true, name: code-execution-prevention>\r\n```\r\n\r\n### Security Control Coverage\r\n```ruby\r\nControls.security_control_coverage\r\n# => [\r\n#      #<Controls::SecurityControlCoverage: enabled: true, coverage: #<Controls::CoverageItem: total: 20, covered: 6,\r\n#      uncovered: 14, percent_covered: 30.0>,\r\n#      assessment_timestamp: 2014-02-06 17:58:06 -0600, name: desktops-with-up-to-date-high-risk-applications,\r\n#      title: high-risk applications up to date>,\r\n#      ...,\r\n#      #<Controls::SecurityControlCoverage: enabled: true, coverage: #<Controls::CoverageItem: total: 3, covered: 3,\r\n#      uncovered: 0, percent_covered: 100.0>,\r\n#      assessment_timestamp: 2014-02-06 17:58:06 -0600, name: desktops-with-email-attachment-filtering-enabled,\r\n#      title: e-mail client attachment filtering enabled>\r\n#    ]\r\n\r\nControls.security_controls('code-execution-prevention')\r\n# => #<Controls::SecurityControlCoverage: enabled: true, coverage: #<Controls::CoverageItem: total: 42, covered: 0, uncovered: 42, percent_covered: 0.0>,\r\n#    assessment_timestamp: 2014-02-06 17:58:06 -0600, name: code-execution-prevention, title: code execution prevention deployed>\r\n```\r\n\r\n### Threats\r\n```ruby\r\n# Retrieve a list of all the threats\r\nControls.threats\r\n# => [#<Controls::Threat: grade: 3, assessment_timestamp: 2014-02-06 17:58:06 -0600, grade_level: POOR, name: overall-malware, title: Overall>]\r\n\r\n# Only retrieve a single threat\r\nControls.threats('overall-malware')\r\n# => #<Controls::Threat: grade: 3, assessment_timestamp: 2014-02-06 17:58:06 -0600, grade_level: POOR, name: overall-malware, title: Overall>\r\n```\r\n\r\n### Threat Vectors\r\n```ruby\r\n# Retrieve a list of all the threat vectors\r\nControls.threat_vectors\r\n# => [#<Controls::ThreatVector: grade: 3, assessment_timestamp: 2014-02-06 17:58:06 -0600, grade_level: POOR, name:\r\nnetwork-borne, title: Network>, ..., #<Controls::ThreatVector: grade: 3, assessment_timestamp: 2014-02-06 17:58:06 -0600, grade_level: POOR, name: email-borne, title: E-mail>]\r\n\r\n# Only retrieve a single threat vector\r\nControls.threat_vectors('network-borne')\r\n# => #<Controls::ThreatVector: grade: 3, assessment_timestamp: 2014-02-06 17:58:06 -0600, grade_level: POOR, name: network-borne, title: Network>\r\n```\r\n\r\n### Trends\r\n```ruby\r\n# Retrieve a set of statistics over time\r\nControls.threat_trends('overall-malware')\r\n# => [#<Controls::Trend: grade: 1.1723226070935302, assessment_timestamp: 2013-12-15 10:07:39 -0600, total_assets: 18>,\r\n#     #<Controls::Trend: grade: 3.2684235618866317, assessment_timestamp: 2014-02-06 17:58:06 -0600, total_assets: 42>]\r\n\r\nControls.threat_vector_trends('network-borne')\r\n# => [#<Controls::Trend: grade: 1.0187000110028335, assessment_timestamp: 2013-12-15 10:07:39 -0600, total_assets: 18>,\r\n#     #<Controls::Trend: grade: 3.497538201261831, assessment_timestamp: 2014-02-06 17:58:06 -0600, total_assets: 42>]\r\n\r\nControls.configuration_trends('antivirus-installed')\r\n# => [#<Controls::Trend: assessment_timestamp: 2013-12-15 10:07:39 -0600, total_assets: 18, covered_assets: 0,\r\n#     covered_percentage: 0.0>, #<Controls::Trend: assessment_timestamp: 2014-02-06 17:58:06 -0600, total_assets: 42,\r\n#     covered_assets: 9, covered_percentage: 21.428571428571427>]\r\n```\r\n\r\n## License\r\nThis project was created by [Erran Carey (@erran)](http://erran.github.io) and licensed under [the MIT License](LICENSE.md).\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}